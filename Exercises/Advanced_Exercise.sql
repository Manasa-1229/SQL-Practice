-- Advanced SQL Exercises
--Exercise 1: Top 3 Most Expensive Products in Each Category
---Objective: Write a SQL query to find the top 3 most expensive products in each category. List the category name, product name, and price.
-- Write your query here:


--Exercise 2: Products Without Reviews
--Objective: Write a SQL query to list all products that have not received any reviews. Display the product name and price.
-- Write your query here:


--Exercise 3: Total Sales Per Month
--Objective: Write a SQL query to calculate the total sales per month. Display the month, year, and total sales amount.
-- Write your query here:



--Exercise 4: Finding Pairs of Products in the Same Category
--Objective: Write a SQL query using a self join to find all pairs of products that are in the same category and have a price difference of less than $50.
-- Write your query here:

  
-- Exercise 5: Hierarchical Category Structure
 -- Objective: Use a Common Table Expression to list all categories along with their subcategories to any depth in a hierarchical format. Assume that the Categories table has category_id and parent_id columns.
-- Write your query here:

  
--Exercise 6: Ranking Products by Price Within Each Category
--Objective: Use a window function to rank products by price within each category. Display the category, product name, price, and rank.
-- Write your query here:


--Exercise 7: Monthly Sales Growth
--Objective: Calculate the month-over-month sales growth percentage for each product. Use CTEs to aggregate monthly sales and window functions to calculate the growth percentage.
-- Write your query here:



--Exercise 8: Identifying Users with Common Orders
--Objective: Find pairs of users who have ordered the same product. List the user IDs and the common product IDs they've ordered.
-- Write your query here:


